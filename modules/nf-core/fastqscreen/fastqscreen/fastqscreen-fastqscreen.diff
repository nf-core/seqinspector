Changes in component 'nf-core/fastqscreen/fastqscreen'
Changes in 'fastqscreen/fastqscreen/environment.yml':
--- modules/nf-core/fastqscreen/fastqscreen/environment.yml
+++ modules/nf-core/fastqscreen/fastqscreen/environment.yml
@@ -4,5 +4,11 @@
   - conda-forge
   - bioconda
 dependencies:
-  - "bioconda::fastq-screen=0.15.3"
+  - bioconda::fastq-screen=0.16.0
   - bioconda::perl-gdgraph=1.54
+  # - gzip
+  # - SAMtools
+  # - bowtie
+  # - bowtie2
+  # - bwa
+  # - bismark

Changes in 'fastqscreen/fastqscreen/main.nf':
--- modules/nf-core/fastqscreen/fastqscreen/main.nf
+++ modules/nf-core/fastqscreen/fastqscreen/main.nf
@@ -4,12 +4,12 @@
 
     conda "${moduleDir}/environment.yml"
     container "${ workflow.containerEngine == 'singularity' && !task.ext.singularity_pull_docker_container ?
-        'https://depot.galaxyproject.org/singularity/fastq-screen:0.15.3--pl5321hdfd78af_0':
-        'biocontainers/fastq-screen:0.15.3--pl5321hdfd78af_0'}"
+        'https://community-cr-prod.seqera.io/docker/registry/v2/blobs/sha256/fc/fc53eee7ca23c32220a9662fbb63c67769756544b6d74a1ee85cf439ea79a7ee/data' :
+        'community.wave.seqera.io/library/fastq-screen_perl-gdgraph:5c1786a5d5bc1309'}"
 
     input:
-    tuple val(meta), path(reads)  // .fastq files
-    path database
+    tuple val(meta), path(reads, arity: '1..2')
+    tuple val(ref_names), path(ref_dirs, name:"ref*"), val(ref_basenames), val(ref_aligners)
 
     output:
     tuple val(meta), path("*.txt")     , emit: txt
@@ -24,31 +24,42 @@
     script:
     def prefix = task.ext.prefix ?: "${meta.id}"
     def args = task.ext.args ?: ""
+    def config_content = ref_names.withIndex().collect { name, i -> "DATABASE ${name} ./${ref_dirs[i]}/${ref_basenames[i]} ${ref_aligners[i]}" }.join('\n')
 
+    // Build mv commands to rename the output files. Dual reads will be appended with '_1' and '_2'
+    def num_reads = reads instanceof List  ? reads.size() : 1
+    def file_extensions = ['txt', 'html', 'png']
+    def mv_cmd = file_extensions.collect { ext ->
+        reads.withIndex().collect { read, i ->
+            "mv ${read.simpleName}_screen.${ext} ${prefix}${num_reads > 1 ? "_${i+1}" : ''}_screen.${ext}"
+        }.join(' && ')
+    }.join(' && ')
     """
-    fastq_screen --threads ${task.cpus} \\
-        --aligner bowtie2 \\
-        --conf ${database}/fastq_screen.conf \\
+    echo '${config_content}' > fastq_screen.conf
+
+    fastq_screen \\
+        --conf fastq_screen.conf \\
+        --threads ${task.cpus} \\
         $reads \\
-        $args \\
+        $args
 
-    cat <<-END_VERSIONS > versions.yml
-    "${task.process}":
-        fastqscreen: \$(echo \$(fastq_screen --version 2>&1) | sed 's/^.*FastQ Screen v//; s/ .*\$//')
-    END_VERSIONS
+    $mv_cmd
+
+    fastq_screen_version=\$(fastq_screen --version 2>&1 | sed 's/^.*FastQ Screen v//; s/ .*\$//')
+    echo "\\\"${task.process}\\\":" > versions.yml
+    echo "    fastqscreen: \$fastq_screen_version" >> versions.yml
     """
 
     stub:
     def prefix = task.ext.prefix ?: "${meta.id}"
     """
-    touch test_1_screen.html
-    touch test_1_screen.png
-    touch test_1_screen.txt
+    touch ${prefix}_screen.html
+    touch ${prefix}_screen.png
+    touch ${prefix}_screen.txt
 
-    cat <<-END_VERSIONS > versions.yml
-    "${task.process}":
-        fastqscreen: \$(echo \$(fastq_screen --version 2>&1) | sed 's/^.*FastQ Screen v//; s/ .*\$//')
-    END_VERSIONS
+    fastq_screen_version=\$(fastq_screen --version 2>&1 | sed 's/^.*FastQ Screen v//; s/ .*\$//')
+    echo "\\\"${task.process}\\\":" > versions.yml
+    echo "    fastqscreen: \$fastq_screen_version" >> versions.yml
     """
 
 }

'modules/nf-core/fastqscreen/fastqscreen/meta.yml' is unchanged
'modules/nf-core/fastqscreen/fastqscreen/tests/main.nf.test' is unchanged
'modules/nf-core/fastqscreen/fastqscreen/tests/main.nf.test.snap' is unchanged
'modules/nf-core/fastqscreen/fastqscreen/tests/nextflow.config' is unchanged
'modules/nf-core/fastqscreen/fastqscreen/tests/tags.yml' is unchanged
************************************************************
